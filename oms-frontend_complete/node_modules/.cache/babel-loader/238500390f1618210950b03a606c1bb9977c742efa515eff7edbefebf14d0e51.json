{"ast":null,"code":"import _objectSpread from\"C:/Users/soniy/Documents/oms-frontend_complete/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import api from\"../api/api\";import\"./Inventory.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const STOCK_THRESHOLD=10;const SALES_THRESHOLD=30;function Inventory(){const[inventoryData,setInventoryData]=useState([]);// ✅ Fetch products from backend on page load\nuseEffect(()=>{async function fetchInventory(){try{const res=await api.get(\"/products\");setInventoryData(res.data);}catch(err){console.error(\"❌ Error fetching inventory:\",err);alert(\"Failed to load inventory.\");}}fetchInventory();},[]);// ✅ Check if stock is critical\nconst isCritical=item=>{return item.stock===0||item.stock<STOCK_THRESHOLD&&item.salesPerDay>SALES_THRESHOLD;};// ✅ Restock item using backend API\nconst restockItem=async(id,name,currentStock)=>{const confirm=window.confirm(\"\\u26A0\\uFE0F Are you sure you physically have more stock of \\\"\".concat(name,\"\\\" in warehouse?\"));if(!confirm)return;try{const newStock=currentStock+20;// ✅ Fixed: send stock update as an object\nawait api.put(\"/products/\".concat(id,\"/stock\"),{stock:newStock});const updated=inventoryData.map(item=>item._id===id?_objectSpread(_objectSpread({},item),{},{stock:newStock}):item);setInventoryData(updated);alert(\"\\u2705 Stock updated for \".concat(name));}catch(err){console.error(\"❌ Failed to update stock:\",err);alert(\"Failed to update stock.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Inventory\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"inventory-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Stock\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Sales/Day\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:inventoryData.map(item=>{const alert=isCritical(item);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.name}),/*#__PURE__*/_jsx(\"td\",{children:item.stock}),/*#__PURE__*/_jsx(\"td\",{children:item.salesPerDay||0}),/*#__PURE__*/_jsx(\"td\",{children:alert?/*#__PURE__*/_jsx(\"span\",{className:\"low-stock\",children:\"\\u26A0\\uFE0F Critical\"}):/*#__PURE__*/_jsx(\"span\",{className:\"in-stock\",children:\"\\u2714\\uFE0F Normal\"})}),/*#__PURE__*/_jsx(\"td\",{children:alert&&/*#__PURE__*/_jsx(\"button\",{className:\"restock-btn\",onClick:()=>restockItem(item._id,item.name,item.stock),children:\"\\u2795 Restock\"})})]},item._id);})})]})]});}export default Inventory;","map":{"version":3,"names":["React","useEffect","useState","api","jsx","_jsx","jsxs","_jsxs","STOCK_THRESHOLD","SALES_THRESHOLD","Inventory","inventoryData","setInventoryData","fetchInventory","res","get","data","err","console","error","alert","isCritical","item","stock","salesPerDay","restockItem","id","name","currentStock","confirm","window","concat","newStock","put","updated","map","_id","_objectSpread","className","children","onClick"],"sources":["C:/Users/soniy/Documents/oms-frontend_complete/src/pages/Inventory.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport api from \"../api/api\";\r\nimport \"./Inventory.css\";\r\n\r\nconst STOCK_THRESHOLD = 10;\r\nconst SALES_THRESHOLD = 30;\r\n\r\nfunction Inventory() {\r\n  const [inventoryData, setInventoryData] = useState([]);\r\n\r\n  // ✅ Fetch products from backend on page load\r\n  useEffect(() => {\r\n    async function fetchInventory() {\r\n      try {\r\n        const res = await api.get(\"/products\");\r\n        setInventoryData(res.data);\r\n      } catch (err) {\r\n        console.error(\"❌ Error fetching inventory:\", err);\r\n        alert(\"Failed to load inventory.\");\r\n      }\r\n    }\r\n\r\n    fetchInventory();\r\n  }, []);\r\n\r\n  // ✅ Check if stock is critical\r\n  const isCritical = (item) => {\r\n    return (\r\n      item.stock === 0 ||\r\n      (item.stock < STOCK_THRESHOLD && item.salesPerDay > SALES_THRESHOLD)\r\n    );\r\n  };\r\n\r\n  // ✅ Restock item using backend API\r\n  const restockItem = async (id, name, currentStock) => {\r\n    const confirm = window.confirm(\r\n      `⚠️ Are you sure you physically have more stock of \"${name}\" in warehouse?`\r\n    );\r\n    if (!confirm) return;\r\n\r\n    try {\r\n      const newStock = currentStock + 20;\r\n\r\n      // ✅ Fixed: send stock update as an object\r\n      await api.put(`/products/${id}/stock`, { stock: newStock });\r\n\r\n      const updated = inventoryData.map((item) =>\r\n        item._id === id ? { ...item, stock: newStock } : item\r\n      );\r\n      setInventoryData(updated);\r\n      alert(`✅ Stock updated for ${name}`);\r\n    } catch (err) {\r\n      console.error(\"❌ Failed to update stock:\", err);\r\n      alert(\"Failed to update stock.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <h2>Inventory</h2>\r\n      <table className=\"inventory-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Product</th>\r\n            <th>Stock</th>\r\n            <th>Sales/Day</th>\r\n            <th>Status</th>\r\n            <th>Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {inventoryData.map((item) => {\r\n            const alert = isCritical(item);\r\n            return (\r\n              <tr key={item._id}>\r\n                <td>{item.name}</td>\r\n                <td>{item.stock}</td>\r\n                <td>{item.salesPerDay || 0}</td>\r\n                <td>\r\n                  {alert ? (\r\n                    <span className=\"low-stock\">⚠️ Critical</span>\r\n                  ) : (\r\n                    <span className=\"in-stock\">✔️ Normal</span>\r\n                  )}\r\n                </td>\r\n                <td>\r\n                  {alert && (\r\n                    <button\r\n                      className=\"restock-btn\"\r\n                      onClick={() => restockItem(item._id, item.name, item.stock)}\r\n                    >\r\n                      ➕ Restock\r\n                    </button>\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Inventory;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}